

# Defense:



#### In Progress

[Simple WMI Trace Viewer in PowerShell](https://chentiangemalc.wordpress.com/2017/03/24/simple-wmi-trace-viewer-in-powershell/)

[Active Directory: Real Defense for Domain Admins](https://www.irongeek.com/i.php?page=videos/derbycon4/t213-active-directory-real-defense-for-domain-admins-jason-lang)
* Did your AD recently get owned on a pentest? It’s always fun to see an unknown entry show up in your Domain Admins group (#fail). Come learn how to truly protect your organization’s IT crown jewels from some of the most popular AD attacks. If you’re stuck trying to figure out what to do with null sessions, pass the hash techniques, or protecting your Domain Admins, then you will want to be here.

[Active Directory Design Best Practices](https://krva.blogspot.com/2008/04/ad-design-best-practices.html)

[Application Whitelisting Using Microsoft AppLocker](https://www.iad.gov/iad/library/ia-guidance/tech-briefs/application-whitelisting-using-microsoft-applocker.cfm)

[Just Enough Administration Samples and Resources](https://github.com/PowerShell/JEA)
* Just Enough Administration (JEA) is a PowerShell security technology that provides a role based access control platform for anything that can be managed with PowerShell. It enables authorized users to run specific commands in an elevated context on a remote machine, complete with full PowerShell transcription and logging. JEA is included in PowerShell version 5 and higher on Windows 10 and Windows Server 2016, and older OSes with the Windows Management Framework updates.


[Detecting DLL Hijacking
 on Windows](http://digital-forensics.sans.org/blog/2015/03/25/detecting-dll-hijacking-on-windows/)

[Second section good resource for hardening windows](http://labs.bitdefender.com/2014/11/do-your-bit-to-limit-cryptowall/)

[GPO Best Policies](http://www.grouppolicy.biz/best-practices/)

http://www.scriptjunkie.us/2013/06/fixing-pass-the-hash-and-other-problems/


[Analyzing Malicious Documents Cheat Sheet](https://zeltser.com/analyzing-malicious-documents/)

https://www.dsinternals.com/en/

[Monit](https://mmonit.com/monit/)
* Monit is a small Open Source utility for managing and monitoring Unix systems. Monit conducts automatic maintenance and repair and can execute meaningful causal actions in error situations.

[Mitigating Kerberos Golden Tickets:](http://cert.europa.eu/static/WhitePapers/CERT-EU-SWP_14_07_PassTheGolden_Ticket_v1_1.pdf)

https://sysforensics.org/2014/01/know-your-windows-processes.html


https://media.blackhat.com/us-13/US-13-Duckwall-Pass-the-Hash-Slides.pdf
* Protecting against Pass-The-Hash and other techniques


http://www.grouppolicy.biz/2011/06/best-practices-group-policy-for-wsus/


[BEAMGUN](https://github.com/JLospinoso/beamgun)
* A rogue-USB-device defeat program for Windows. 

[Defending against mimikatz](https://jimshaver.net/2016/02/14/defending-against-mimikatz/)


[Mitigating Pass-the-Hash Attacks and other credential Theft-version2](http://download.microsoft.com/download/7/7/A/77ABC5BD-8320-41AF-863C-6ECFB10CB4B9/Mitigating-Pass-the-Hash-Attacks-and-Other-Credential-Theft-Version-2.pdf)
* Official MS paper.

[Windows Firewall Hook Enumeration](https://www.nccgroup.com/en/blog/2015/01/windows-firewall-hook-enumeration/)
* We’re going to look in detail at Microsoft Windows Firewall Hook drivers from Windows 2000, XP and 2003. This functionality was leveraged by the Derusbi family of malicious code to implement port-knocking like functionality. We’re going to discuss the problem we faced, the required reverse engineering to understand how these hooks could be identified and finally how the enumeration tool was developed.

[Windows ISV Software Security Defenses](https://msdn.microsoft.com/en-us/library/bb430720.aspx)

[Harden windows IP Stack](https://www.reddit.com/r/netsec/comments/2sg80a/how_to_harden_windowsiis_ssltls_configuration/)



[The 10 Windows group policy settings you need to get right](http://www.infoworld.com/article/2609578/security/the-10-windows-group-policy-settings-you-need-to-get-right.html?page=2)





[Windows Performance Toolkit Reference](http://msdn.microsoft.com/en-us/library/windows/hardware/hh162945.aspx)

[Powershell Security at Enterprise Customers](https://blogs.msdn.microsoft.com/daviddasneves/2017/05/25/powershell-security-at-enterprise-customers/)


[AIL framework - Analysis Information Leak framework](https://github.com/CIRCL/AIL-framework)
* AIL is a modular framework to analyse potential information leaks from unstructured data sources like pastes from Pastebin or similar services or unstructured data streams. AIL framework is flexible and can be extended to support other functionalities to mine sensitive information.

[Linux workstation security checklist](https://github.com/lfit/itpol/blob/master/linux-workstation-security.md)

[Uproot](https://github.com/Invoke-IR/Uproot)
* Uproot is a Host Based Intrusion Detection System (HIDS) that leverages Permanent Windows Management Instrumentation (WMI) Event Susbcriptions to detect malicious activity on a network. For more details on WMI Event Subscriptions please see the WMIEventing Module


[What would a real hacker do to your Active Directory](https://www.youtube.com/watch?v=DH3v8bO-NCs)


[Mozilla's OpenSSH Configuration guide](https://wiki.mozilla.org/Security/Guidelines/OpenSSH)

Use Invoke-HoneyCreds to distribute fake cred throughout environment as "legit" service account and monitor for use of creds


[SMB Packet Signing](https://technet.microsoft.com/en-us/library/cc180803.aspx)


[Public:Windows Event Log Zero 2 Hero Slides](https://docs.google.com/presentation/d/1dkrldTTlN3La-OjWtkWJBb4hVk6vfsSMBFBERs6R8zA/edit#slide=id.g21acf94f3f_2_27)



[Blocking Remote Use of Local Accounts](https://blogs.technet.microsoft.com/secguide/2014/09/02/blocking-remote-use-of-local-accounts/)


http://www.leeholmes.com/blog/2016/10/22/more-detecting-obfuscated-powershell/


The Hitchhiker's Guide to SQL Injection prevention - https://phpdelusions.net/sql_injection


[Amazon S3 Bucket Public Access Considerations](https://aws.amazon.com/articles/5050)

[Filenames and Pathnames in Shell: How to do it Correctly](https://www.dwheeler.com/essays/filenames-in-shell.html)

[Threats and Countermeasures Guide: Security Settings in Windows Server 2008 R2 and Windows 7 - technet](https://technet.microsoft.com/en-us/library/hh125921.aspx)


[Securi-Tay 2017 - Advanced Attack Detection](https://www.youtube.com/watch?v=ihElrBBJQo8)
* 

[Common misconfigurations that lead to a breach - Justin Tharpe](https://www.youtube.com/watch?v=fI3mycr5cPg)


[Securing Windows Workstations: Developing a Secure Baseline](https://adsecurity.org/?p=3299)

[PowerShell Security at Enterprise Customers - msdn](https://blogs.msdn.microsoft.com/daviddasneves/2017/05/25/powershell-security-at-enterprise-customers/)

[Assimilator](https://github.com/videlanicolas/assimilator)
* Automatic firewall rule orchestator.

[Uproot](https://github.com/Invoke-IR/Uproot)
* Uproot is a Host Based Intrusion Detection System (HIDS) that leverages Permanent Windows Management Instrumentation (WMI) Event Susbcriptions to detect malicious activity on a network. For more details on WMI Event Subscriptions please see the WMIEventing Module

[WMIEvent](https://github.com/Invoke-IR/WMIEvent)
* A PowerShell module to abstract the complexities of Permanent WMI Event Subscriptions


[LUNAR](https://github.com/lateralblast/lunar)
* A UNIX security auditing tool based on several security frameworks


[OverSight](https://objective-see.com/products/oversight.html)
* OverSight monitors a mac's mic and webcam, alerting the user when the internal mic is activated, or whenever a process accesses the webcam. 


[Detecting Forged Kerberos Ticket (Golden Ticket & Silver Ticket) Use in Active Directory](http://adsecurity.org/?p=1515)


[How to Efficiently Protect AD from Credential Theft & Compromise - Friedwart Kuhn - Troopers15](https://www.youtube.com/watch?v=I4mb0UciqlY)

[Defending the Enterprise Against Network Infrastructure Attacks  - Paul Coggin - Troopers15](https://www.youtube.com/watch?v=K0X3RDf5XK8)

[Kerberos Golden Ticket: Mitigating pass the ticket on Active Directory](http://cert.europa.eu/static/WhitePapers/CERT-EU-SWP_14_07_PassTheGolden_Ticket_v1_1.pdf)

[TaskExplorer](https://objective-see.com/products/taskexplorer.html)
* Explore all the tasks (processes) running on your Mac with TaskExplorer. 


[Password Policy - technet](https://technet.microsoft.com/en-us/library/hh994572.aspx)

[Account lockout threshold - technet](https://technet.microsoft.com/en-us/library/hh994574.aspx)

[Guide to Application Whitelisting - NIST Special Publication 800 - 167](http://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-167.pdf)

[Script Rules in AppLocker - technet](https://technet.microsoft.com/en-us/library/ee460958.aspx)

[DLL Rules in AppLocker](https://technet.microsoft.com/en-us/library/ee460947.aspx)

[Microsoft Security Advisory 2871997](https://technet.microsoft.com/library/security/2871997)
* [Microsoft Security Advisory: Update to improve credentials protection and management: May 13, 2014](https://support.microsoft.com/en-us/help/2871997/microsoft-security-advisory-update-to-improve-credentials-protection-a)
[Windows Defender Device Guard deployment guide - docs ms](https://docs.microsoft.com/en-us/windows/device-security/device-guard/device-guard-deployment-guide)


### Active Directory








### OS X
[netman](https://github.com/iadgov/netman)
* A userland network manager with monitoring and limiting capabilities for macOS.

[netfil](https://github.com/iadgov/netfil)
* A kernel network manager with monitoring and limiting capabilities for macOS.