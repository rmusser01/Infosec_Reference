Network Footprinting

    Network Footprinting (Reconnaissance) The tester would attempt to gather as much information as possible about the selected network. Reconnaissance can take two forms i.e. active and passive. A passive attack is always the best starting point as this would normally defeat intrusion detection systems and other forms of protection etc. afforded to the network. This would usually involve trying to discover publicly available information by utilising a web browser and visiting newsgroups etc. An active form would be more intrusive and may show up in audit logs and may take the form of an attempted DNS zone transfer or a social engineering type of attack.

        Whois is widely used for querying authoritative registries/ databases to discover the owner of a domain name, an IP address, or an autonomous system number of the system you are targeting.
            Authoratitive Bodies
                IANA - Internet Assigned Numbers Authority
                ICANN - Internet Corporation for Assigned Names and Numbers.
                NRO - Number Resource Organisation
                RIR - Regional Internet Registry
                    AFRINIC - African Network Information Centre
                    APNIC - Asia Pacific Network Information Centre
                        National Internet Registry
                            APJII
                            CNNIC
                            JPNIC
                            KRNIC
                            TWNIC
                            VNNIC
                    ARIN - American Registry for Internet Numbers
                    LACNIC - Latin America & Caribbean Network Information Centre
                    RIPE - Reseaux IP Européens—Network Coordination Centre
            Websites
                Central Ops
                    Domain Dossier
                    Email Dossier
                DNS Stuff
                    Online DNS one-stop shop, with the ability to perform a great deal of disparate DNS type queries.
                Fixed Orbit
                    Autonomous System lookups and other online tools available.
                Geektools
                IP2Location
                    Allows limited free IP lookups to be performed, displaying geolocation information, ISP details and other pertinent information.
                Kartoo
                    Metasearch engine that visually presents its results.
                MyIPNeighbors.com
                    Excellent site that gives you details of shared domains on the IP queried/ conversely IP to DNS resolution
                Netcraft
                    Online search tool allowing queries for host information.
                Robtex
                    Excellent website allowing DNS and AS lookups to be performed with a graphical display of the results with pointers, A, MX records and AS connectivity displayed.
                    Note: - Can be unreliable with old entries (Use CentralOps to verify)
                Traceroute.org
                    Website listing a large number links to online traceroute resources.
                Wayback Machine
                    Stores older versions of websites, making it a good comparison tool and excellent resource for previously removed data.
                Whois.net
            Tools
                Cheops-ng
                Country whois
                Domain Research Tool
                Firefox Plugins
                    AS Number
                    Shazou
                    Firecat Suite
                Gnetutil
                Goolag Scanner
                Greenwich
                Maltego
                GTWhois
                Sam Spade
                Smart whois
                SpiderFoot
        Internet Search
            General Information
                Web Investigator
                Tracesmart
                Friends Reunited
                Ebay - profiles etc.
            Financial
                EDGAR - Company information, including real-time filings. US
                Google Finance - General Finance Portal
                Hoovers - Business Intelligence, Insight and Results. US and UK
                Companies House UK
                Land Registry UK
            Phone book/ Electoral Role Information
                123people
                    http://www.123people.co.uk/s/firstname+lastname/world
                192.com
                    Electoral Role Search. UK
                411
                    Online White Pages and Yellow Pages. US

                Abika
                    Background Check, Phone Number Lookup, Trace email, Criminal record, Find People, cell phone number search, License Plate Search. US
                BT.com. UK
                    Residential
                    Business
                Pipl

                    http://pipl.com/search/?FirstName=????&LastName=????&City=&State=&Country=UK&CategoryID=2&Interface=1
                    http://pipl.com/search/?Email=john%40example.com&CategoryID=4&Interface=1
                    http://pipl.com/search/?Username=????&CategoryID=5&Interface=1
                Spokeo
                    http://www.spokeo.com/user?q=domain_name
                    http://www.spokeo.com/user?q=email_address
                Yasni
                    http://www.yasni.co.uk/index.php?action=search&search=1&sh=&name=firstname+lastname&filter=Keyword
                Zabasearch
                    People Search Engine. US
            Generic Web Searching
                Code Search
                Forum Entries
                Google Hacking Database
                Google
                    Back end files
                        .exe / .txt / .doc / .ppt / .pdf / .vbs / .pl / .sh / .bat / .sql / .xls / .mdb / .conf
                    Email Addresses
                    Contact Details
                Newsgroups/forums
                Blog Search
                    Yammer
                    Google Blog Search
                        http://blogsearch.google.com/blogsearch?hl=en&ie=UTF-8&q=????&btnG=Search+Blogs
                    Technorati
                        http://technorati.com/search/[query]?language=n
                    Jaiku
                    Present.ly
                    Twitter Network Browser
                Search Engine Comparison/ Aggregator Sites
                    Clusty
                        http://clusty.com/search?input-form=clusty-simple&v%3Asources=webplus&query=????
                    Grokker
                        http://live.grokker.com/grokker.html?query=?????&OpenSearch_Yahoo=true&Wikipedia=true&numResults=250
                    Zuula
                        http://www.zuula.com/SearchResult.jsp?bst=1&prefpg=1&st=????&x=0&y=0
                    Exalead

                        http://www.exalead.co.uk/search/results?q=????&x=0&y=0&%24mode=allweb&%24searchlanguages=en
                    Delicious
                        http://delicious.com/search?p=?????&u=&chk=&context=&fr=del_icio_us&lc=0
            Metadata Search

                Metadata can be found within various file formats. Dependant on the file types to be inspected, the more metadata can be extracted. Example metadata that can be extracted includes valid usernames, directory structures etc. make the review of documents/ images etc. relating to the target domain a valuable source of information.
                    MetaData Visualisation Sites
                        TouchGraph Google Browser
                        Kartoo
                    Tools
                        Bashitsu
                            svn checkout http://bashitsu.googlecode.com/svn/trunk/
                            cat filename | strings | bashitsu-extract-names
                        Bintext
                        Exif Tool
                            exiftool -common directory
                            exiftool -r -w .txt -common directory
                        FOCA
                            Online Version
                            Offline
                        Hachoir
                        Infocrobes
                        Libextractor
                            extract -b filename
                            extract filename
                            extract -B country_code filename
                        Metadata Extraction Tool
                            extract.bat <arg1> <arg2> <arg3>
                        Metagoofil
                            metagoofil -d target_domain -l max_no_of_files -f all ( or pdf,doc,xls,ppt) -o output_file.html -t directory_to_download_files_to
                        OOMetaExtractor
                        The Revisionist
                            ./therev '' @/directory
                            ./therev '' site.com
                            ./therev 'linux' microsoft.com en
                        Wvware
                    Wikipedia Metadata Search
                        Wikiscanner
                        Wikipedia username checker
            Social/ Business Networks

                The following sites are some of many social and business related networking entities that are in use today.  Dependant on the interests of the people you are researching it may be worth just exploring sites that they have a particular penchant based on prior knowledge from open source research, company biographies etc. i.e. Buzznet if they are interested in music/ pop culture, Flixter for movies etc.

                Finding a persons particular interests may make a potential client side attack more successful if you can find a related "hook" in any potential "spoofed" email sent for them to click on (A Spearphishing technique)

                Note: - This list is not exhaustive and has been limited to those with over 1 million members.
                    Africa
                        BlackPlanet
                    Australia
                        Bebo
                    Belgium
                        Netlog
                    Holland
                        Hyves
                    Hungary
                        iWiW
                    Iran
                        Cloob
                    Japan
                        Mixi
                    Korea
                        CyWorld
                    Poland
                        Grono
                        Nasza-klasa
                    Russia
                        Odnoklassniki
                        Vkontakte
                    Sweden
                        LunarStorm
                    UK
                        FriendsReunited et al
                        Badoo
                        FaceParty
                    US
                        Classmates
                        Facebook
                        Friendster
                        MyLife.com (formerly Reunion.com)
                        MySpace
                        Windows Live Spaces
                    Assorted
                        Buzznet
                        Care2
                        Habbo
                        Hi5
                        Linkedin
                        MocoSpace
                        Naymz
                        Orkut
                        Passado
                        Tagged
                        Twitter
                        Windows Live Spaces
                        Xanga
                        Yahoo! 360°
                        Xing
                            http://www.xing.com/app/search?op=universal&universal=????
            Resources
                OSINT
                International Directory of Search Engines
        DNS Record Retrieval from publically available servers
            Types of Information Records
                SOA Records - Indicates the server that has authority for the domain.
                MX Records - List of a host's or domain's mail exchanger server(s).
                NS Records - List of a host's or domain's name server(s).
                A Records - An address record that allows a computer name to be translated to an IP address. Each computer has to have this record for its IP address to be located via DNS.
                PTR Records - Lists a host's domain name, host identified by its IP address.
                SRV Records - Service location record.
                HINFO Records - Host information record with CPU type and operating system.
                TXT Records - Generic text record.
                CNAME - A host's canonical name allows additional names/ aliases to be used to locate a computer.
                RP - Responsible person for the domain.
            Database Settings
                Version.bind
                Serial
                Refresh
                Retry
                Expiry
                Minimum
            Sub Domains
            Internal IP ranges
                Reverse DNS for IP Range
            Zone Transfer
        Social Engineering
            Remote
                Phone
                    Scenarios
                        IT Department."Hi, it's Zoe from the helpdesk. I am doing a security audit of the networkand I need to re-synchronise the Active Directory usernames and passwords.This is so that your logon process in the morning receives no undue delays"If you are calling from a mobile number, explain that the helpdesk has beenissued a mobile phone for 'on call' personnel.
                    Results
                    Contact Details
                        Name
                        Phone number
                        Email
                        Room number
                        Department
                        Role
                Email
                    Scenarios
                        Hi there, I am currently carrying out an Active Directory Health Checkfor TARGET COMPANY and require to re-synchronise some outstandingaccounts on behalf of the IT Service Desk. Please reply to medetailing the username and password you use to logon to your desktopin the morning. I have checked with MR JOHN DOE, the IT SecurityAdvisor and he has authorised this request. I will then populate thedatabase with your account details ready for re-synchronisation withActive Directory such that replication of your account will bere-established (this process is transparent to the user and sorequires no further action from yourself). We hope that this exercisewill reduce the time it takes for some users to logon to the network.Best Regards, Andrew Marks
                        Good Morning,The IT Department had a critical failure last night regarding remote access to the corporate network, this will only affect users that occasionally work from home.If you have remote access, please email me with your username and access requirements e.g. what remote access system did you use? VPN and IP address etc, and we will reset the system. We are also using this 'opportunity' to increase the remote access users, so if you believe you need to work from home occasionally, please email me your usernames so I can add them to the correct groups.If you wish to retain your current credentials, also send your password. We do not require your password to carry out the maintainence, but it will change if you do not inform us of it.We apologise for any inconvenience this failure has caused and are working to resolve it as soon as possible. We also thank you for your continued patience and help.Kindest regards,leeEMAIL SIGNATURE
                    Software
                    Results
                    Contact Details
                        Name
                        Phone number
                        Email
                        Room number
                        Department
                        Role
                Other
            Local
                Personas
                    Name
                        Suggest same 1st name.
                    Phone
                        Give work mobile, but remember they have it!
                    Email
                        Have a suitable email address
                    Business Cards
                        Get cards printed
                Contact Details
                    Name
                    Phone number
                    Email
                    Room number
                    Department
                    Role
                Scenarios
                    New IT employee
                        New IT employee."Hi, I'm the new guy in IT and I've been told to do a quick survey of users on the network. They give all the worst jobs to the new guys don't they? Can you help me out on this?"Get the following information, try to put a "any problems with it we can help with?" slant on it.UsernameDomainRemote access (Type - Modem/VPN)Remote email (OWA)Most used software?Any comments about the network?Any additional software you would like?What do you think about the security on the network? Password complexity etc.Now give reasons as to why they have complexity for passwords, try and get someone to give you their password and explain how you can make it more secure."Thanks very much and you'll see the results on the company boards soon."
                    Fire Inspector
                        Turning up on the premise of a snap fire inspection, in line with the local government initiatives on fire safety in the workplace.Ensure you have a suitable appearance - High visibility jacket - Clipboard - ID card (fake).Check for:number of fire extinguishers, pressure, type.Fire exits, accessibility etc.Look for any information you can get. Try to get on your own, without supervision!
                Results
                Maps
                    Satalitte Imagery
                        Google Maps
                    Building layouts
                Other
        Dumpster Diving
            Rubbish Bins
            Contract Waste Removal
            Ebay ex-stock sales i.e. HDD
        Web Site copy
            htttrack
            teleport pro
            Black Widow